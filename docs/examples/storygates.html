<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Gates - SimpleQBN</title>
    <meta name="description" content="Because nothing about quality-based narratives is actually simple.">
    <link rel="stylesheet" href="/simple-qbn/assets/css/style.css">
</head>
<body>
    <div class="book">
        <nav class="sidebar">
  <div class="book-summary">
    <h2>SimpleQBN</h2>
    <ul class="summary">
      
      <li class="chapter ">
        
        <a href="/simple-qbn/">Introduction</a>
        
        
      </li>
      
      <li class="chapter has-children">
        
        <span class="section-title">History of Related Terms</span>
        
        
        <ul class="articles">
          
          <li>
            <a href="/simple-qbn/scenes">Scenes and Cycles (1983)</a>
          </li>
          
          <li>
            <a href="/simple-qbn/episodes">Episodes and Sequences (1989)</a>
          </li>
          
          <li>
            <a href="/simple-qbn/sculpturalmodel">Sculptural Hypertext Model (2001)</a>
          </li>
          
          <li>
            <a href="/simple-qbn/storylet">Storylet (2010)</a>
          </li>
          
          <li>
            <a href="/simple-qbn/qbn">Quality-Based Narrative (2010)</a>
          </li>
          
        </ul>
        
      </li>
      
      <li class="chapter has-children">
        
        <span class="section-title">Metaphors in SimpleQBN</span>
        
        
        <ul class="articles">
          
          <li>
            <a href="/simple-qbn/expressions">Expressions and QualitySet</a>
          </li>
          
          <li>
            <a href="/simple-qbn/cards">Decks and Cards</a>
          </li>
          
          <li>
            <a href="/simple-qbn/State">State Management</a>
          </li>
          
        </ul>
        
      </li>
      
      <li class="chapter has-children">
        
        <span class="section-title">Examples</span>
        
        
        <ul class="articles">
          
          <li>
            <a href="/simple-qbn/examples/deckbuilding">Deck Building</a>
          </li>
          
          <li>
            <a href="/simple-qbn/examples/storygates">Story Gates</a>
          </li>
          
          <li>
            <a href="/simple-qbn/examples/webbuild">Bundled for Web</a>
          </li>
          
        </ul>
        
      </li>
      
    </ul>
  </div>
</nav>

        <div class="book-body">
            <div class="body-inner">
                <div class="page-wrapper">
                    <div class="page-inner">
                        <div class="markdown-section">
<h1 id="story-gating">Story Gating</h1>

<p>Emily Short (2016, 2019), among others, have discussed different moments in narratives models as “gates.” These happen when one set of narrative units (usually storylets) are available and then another collection are added or become dominant once certain conditions are met.</p>

<p>In SimpleQBN, one way to conceive of story gates is through using the key-value pairs within <strong>State</strong> with the <em>qualities</em> of <strong>Cards</strong>.</p>

<h2 id="using-manual-state-based-api">Using manual, State-based API</h2>

<p>Consider the following code:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a new Deck</span>
<span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Deck</span><span class="p">();</span>
<span class="c1">// Add a key-value pair</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Create four cards</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">First</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Third</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Fourth</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="c1">// Pass a size of 4, but only two cards are available</span>
<span class="kd">const</span> <span class="nx">hand</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</code></pre></div></div>

<p>When run, any calls to the method <em>draw()</em> in the <strong>Deck</strong> would only select available <strong>Cards</strong>. Currently, these are only <strong>Cards</strong> with the <em>content</em> of “First” and “Second”.</p>

<p>These different qualities “gate” the other content from being used. However, these can be enabled through adjusting the values of the <em>state</em> (based on <strong>State</strong>) of the <strong>Deck</strong> using the method <em>set()</em> with the key-value pair to change.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a new Deck</span>
<span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Deck</span><span class="p">();</span>
<span class="c1">// Add a key-value pair</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Create four cards</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">First</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Third</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Fourth</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="c1">// Change the deck's state</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">// Pass a size of 4, but only two cards are available</span>
<span class="kd">const</span> <span class="nx">hand</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</code></pre></div></div>

<p>In the new code, only the last two cards are available. These are cards with the <em>content</em> of “Third” and “Fourth”.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a new Deck</span>
<span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Deck</span><span class="p">();</span>
<span class="c1">// Add a key-value pair</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Create four cards</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">First</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Third</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="dl">"</span><span class="s2">Fourth</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="c1">// Shuffle the cards</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">shuffle</span><span class="p">();</span>
<span class="c1">// Change the deck's state</span>
<span class="nx">d</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">// Pass a size of 4, but only two cards are available</span>
<span class="kd">const</span> <span class="nx">hand</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</code></pre></div></div>

<p>The method <em>shuffle()</em> of <strong>Deck</strong> changes the order of <strong>Cards</strong>, not their availability. This allows for randomly sorting the cards, if wanted.</p>

<h2 id="using-automatic-reactive-state-based-api">Using automatic, Reactive State-based API</h2>

<p>The reactive architecture provides the same story gating functionality with automatic updates and event-driven state management. Instead of manual state checking, reactive components automatically synchronize when gate conditions change.</p>

<blockquote>
  <p><strong>Note</strong>: The examples below use the new nested import structure available in SimpleQBN 1.5.0+. These reactive classes are incompatible with the original State-based classes shown above.</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">Card</span><span class="p">,</span> <span class="nx">Deck</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">simple-qbn/reactive</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Create a reactive state and deck</span>
<span class="kd">const</span> <span class="nx">gameState</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">State</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Deck</span><span class="p">([],</span> <span class="nx">gameState</span><span class="p">);</span>
<span class="c1">// Add a key-value pair</span>
<span class="nx">gameState</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Create four cards bound to the reactive state</span>
<span class="kd">const</span> <span class="nx">card1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">First</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Third</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card4</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Fourth</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card1</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card2</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card3</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card4</span><span class="p">);</span>
<span class="c1">// Get available cards</span>
<span class="kd">const</span> <span class="nx">available</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">availableCards</span><span class="p">;</span>
</code></pre></div></div>

<p>When run, any calls to the method <em>draw()</em> in the <strong>ReactiveDeck</strong> would only select available <strong>ReactiveCards</strong>. Currently, these are only <strong>ReactiveCards</strong> with the <em>content</em> of “First” and “Second”. The reactive system automatically monitors state changes and updates card availability in real-time.</p>

<p>These different qualities “gate” the other content from being used. However, unlike the original architecture, reactive gates are automatically enforced through the subscription system. When gate conditions change, all connected components are notified automatically.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">Card</span><span class="p">,</span> <span class="nx">Deck</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">simple-qbn/reactive</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Create a reactive state and deck</span>
<span class="kd">const</span> <span class="nx">gameState</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">State</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Deck</span><span class="p">([],</span> <span class="nx">gameState</span><span class="p">);</span>
<span class="c1">// Add a key-value pair</span>
<span class="nx">gameState</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Create four cards bound to the reactive state</span>
<span class="kd">const</span> <span class="nx">card1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">First</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Third</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card4</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Fourth</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card1</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card2</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card3</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card4</span><span class="p">);</span>

<span class="c1">// Subscribe to automatic gate changes</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">subscribe</span><span class="p">((</span><span class="nx">availableCards</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Gate changed: </span><span class="p">${</span><span class="nx">availableCards</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2"> cards now available`</span><span class="p">);</span>
  <span class="nx">availableCards</span><span class="p">.</span><span class="nf">forEach</span><span class="p">(</span><span class="nx">card</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`- </span><span class="p">${</span><span class="nx">card</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span><span class="s2">`</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Change the reactive state (automatically triggers gate change)</span>
<span class="nx">gameState</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">// Get available cards</span>
<span class="kd">const</span> <span class="nx">available</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">availableCards</span><span class="p">;</span>
</code></pre></div></div>

<p>In the new code, only the last two cards are available. These are cards with the <em>content</em> of “Third” and “Fourth”. The reactive system automatically recalculated card availability when the state changed, and all subscribers were notified of the gate transition.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">Card</span><span class="p">,</span> <span class="nx">Deck</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">simple-qbn/reactive</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Create a reactive state and deck</span>
<span class="kd">const</span> <span class="nx">gameState</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">State</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Deck</span><span class="p">([],</span> <span class="nx">gameState</span><span class="p">);</span>
<span class="c1">// Add a key-value pair</span>
<span class="nx">gameState</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">// Create four cards bound to the reactive state</span>
<span class="kd">const</span> <span class="nx">card1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">First</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 1</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Third</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="kd">const</span> <span class="nx">card4</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Card</span><span class="p">(</span><span class="dl">"</span><span class="s2">Fourth</span><span class="dl">"</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$example == 2</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card1</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card2</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card3</span><span class="p">);</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">addCard</span><span class="p">(</span><span class="nx">card4</span><span class="p">);</span>

<span class="c1">// Subscribe to all deck changes</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">subscribe</span><span class="p">((</span><span class="nx">availableCards</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">availableCards</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2"> cards available after change`</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Shuffle the cards (notifies subscribers)</span>
<span class="nx">d</span><span class="p">.</span><span class="nf">shuffle</span><span class="p">();</span>
<span class="c1">// Change the reactive state (automatically triggers gate change)</span>
<span class="nx">gameState</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">// Get available cards</span>
<span class="kd">const</span> <span class="nx">available</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">availableCards</span><span class="p">;</span>
</code></pre></div></div>

<p>The method <em>shuffle()</em> of <strong>ReactiveDeck</strong> changes the order of <strong>ReactiveCards</strong>, not their availability. This allows for randomly sorting the cards, if wanted. However, unlike the original architecture, the reactive system automatically notifies all subscribers when the shuffle occurs, enabling real-time updates to any connected UI or game logic.</p>

<p>The reactive architecture makes story gates particularly powerful by enabling automatic propagation of gate changes throughout the entire narrative system. When a story gate condition is met, all connected decks, cards, and UI elements can respond immediately without manual intervention.</p>

<h2 id="references">References</h2>

<p>Short, E. (2016). Beyond Branching: Quality-Based, Salience-Based, and Waypoint Narrative Structures. Emily Short’s Interactive Storytelling. Retrieved from <code class="language-javascript highlighter-rouge"><span class="nx">https</span><span class="p">:</span><span class="c1">//emshort.blog/2016/04/12/beyond-branching-quality-based-and-salience-based-narrative-structures/</span></code></p>

<p>Short, E. (2019). Storylets: You Want Them. Emily Short’s Interactive Storytelling. Retrieved from <code class="language-javascript highlighter-rouge"><span class="nx">https</span><span class="p">:</span><span class="c1">//emshort.blog/2019/11/29/storylets-you-want-them/</span></code></p>

</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
