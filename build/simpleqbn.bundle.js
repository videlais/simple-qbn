!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SimpleQBN=e():t.SimpleQBN=e()}(this,()=>(()=>{"use strict";var t={698:t=>{class e extends SyntaxError{constructor(t,e,r,n){super(t),this.expected=e,this.found=r,this.location=n,this.name="SyntaxError"}format(t){let e="Error: "+this.message;if(this.location){let r=null;const n=t.find(t=>t.source===this.location.source);n&&(r=n.text.split(/\r\n|\n|\r/g));const s=this.location.start,o=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,i=this.location.source+":"+o.line+":"+o.column;if(r){const t=this.location.end,n="".padEnd(o.line.toString().length," "),u=r[s.line-1],a=(s.line===t.line?t.column:u.length+1)-s.column||1;e+="\n --\x3e "+i+"\n"+n+" |\n"+o.line+" | "+u+"\n"+n+" | "+"".padEnd(s.column-1," ")+"".padEnd(a,"^")}else e+="\n at "+i}return e}static buildMessage(t,e){function r(t){return t.codePointAt(0).toString(16).toUpperCase()}const n=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function s(t){return n?t.replace(n,t=>"\\u{"+r(t)+"}"):t}function o(t){return s(t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,t=>"\\x0"+r(t)).replace(/[\x10-\x1F\x7F-\x9F]/g,t=>"\\x"+r(t)))}function i(t){return s(t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,t=>"\\x0"+r(t)).replace(/[\x10-\x1F\x7F-\x9F]/g,t=>"\\x"+r(t)))}const u={literal:t=>'"'+o(t.text)+'"',class(t){const e=t.parts.map(t=>Array.isArray(t)?i(t[0])+"-"+i(t[1]):i(t));return"["+(t.inverted?"^":"")+e.join("")+"]"+(t.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:t=>t.description};function a(t){return u[t.type](t)}return"Expected "+function(t){const e=t.map(a);if(e.sort(),e.length>0){let t=1;for(let r=1;r<e.length;r++)e[r-1]!==e[r]&&(e[t]=e[r],t++);e.length=t}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."}}t.exports={StartRules:["Start"],SyntaxError:e,parse:function(t,r){const n={},s=(r=void 0!==r?r:{}).grammarSource,o={Start:ve};let i=ve;const u="null",a="(",l=")",c="true",h="false",f="!",p="&&",d="AND",g="and",y="||",m="OR",b="or",x="==",w=">",v=">=",A="<",_="<=",C="!=",E="is not",S="is",j="gt",O="lt",P="lte",k="gte",q=".",D="-",R="$",U="[",$="]",F='"',N="'",M=/^[ \t\n\r]/,Q=/^[0-9]/,I=/^[a-zA-Z_]/,L=/^[\-_]/,V=/^[ \-_]/,B=me("Boolean Value"),z=me("Null Value"),G=ge("null",!1),K=ye([" ","\t","\n","\r"],!1,!1,!1),T=me("Left Parentheses"),W=ge("(",!1),Z=me("Right Parentheses"),H=ge(")",!1),J=me("True"),X=ge("true",!1),Y=me("False"),tt=ge("false",!1),et=me("Negation"),rt=ge("!",!1),nt=me("And Operator"),st=ge("&&",!1),ot=ge("AND",!1),it=ge("and",!1),ut=me("Or Operator"),at=ge("||",!1),lt=ge("OR",!1),ct=ge("or",!1),ht=me("Equality"),ft=ge("==",!1),pt=me("Greater-than"),dt=ge(">",!1),gt=me("Greater-than or equal"),yt=ge(">=",!1),mt=me("Less-than"),bt=ge("<",!1),xt=me("Less-than or equal"),wt=ge("<=",!1),vt=me("Inequality"),At=ge("!=",!1),_t=me("Inequality Shorthand"),Ct=ge("is not",!1),Et=me("Equality Shorthand"),St=ge("is",!1),jt=me("Greater-than Shorthand"),Ot=ge("gt",!1),Pt=me("Less-than Shorthand"),kt=ge("lt",!1),qt=me("Less-than or equal Shorthand"),Dt=ge("lte",!1),Rt=me("Greater-than or equal Shorthand"),Ut=ge("gte",!1),$t=me("Digit"),Ft=ye([["0","9"]],!1,!1,!1),Nt=me("Decimal Point"),Mt=ge(".",!1),Qt=me("Number"),It=me("Integer"),Lt=me("Decimal"),Vt=me("Negative"),Bt=ge("-",!1),zt=me("Letter"),Gt=ye([["a","z"],["A","Z"],"_"],!1,!1,!1),Kt=me("Variable"),Tt=ge("$",!1),Wt=me("Variable With Whitespace"),Zt=me("Variable Retrieval"),Ht=me("Key-Value Retrieval"),Jt=me("Dot Notation"),Xt=me("Bracket Notation"),Yt=ge("[",!1),te=ge("]",!1),ee=me("Dot Key"),re=me("Bracket Key"),ne=ye(["-","_"],!1,!1,!1),se=ge('"',!1),oe=ye([" ","-","_"],!1,!1,!1),ie=ge("'",!1),ue=me("String Literal");let ae=0|r.peg$currPos,le=ae;const ce=[{line:1,column:1}];let he,fe=ae,pe=r.peg$maxFailExpected||[],de=0|r.peg$silentFails;if(r.startRule){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function ge(t,e){return{type:"literal",text:t,ignoreCase:e}}function ye(t,e,r,n){return{type:"class",parts:t,inverted:e,ignoreCase:r,unicode:n}}function me(t){return{type:"other",description:t}}function be(e){let r,n=ce[e];if(n)return n;if(e>=ce.length)r=ce.length-1;else for(r=e;!ce[--r];);for(n=ce[r],n={line:n.line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return ce[e]=n,n}function xe(t,e,r){const n=be(t),o=be(e),i={source:s,start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:o.line,column:o.column}};return r&&s&&"function"==typeof s.offset&&(i.start=s.offset(i.start),i.end=s.offset(i.end)),i}function we(t){ae<fe||(ae>fe&&(fe=ae,pe=[]),pe.push(t))}function ve(){let t;return t=Ae(),t}function Ae(){let t,e,r,s,o,i;if(t=ae,e=_e(),e!==n){for(r=[],s=ae,o=Oe(),o!==n?(i=_e(),i!==n?(o=[o,i],s=o):(ae=s,s=n)):(ae=s,s=n);s!==n;)r.push(s),s=ae,o=Oe(),o!==n?(i=_e(),i!==n?(o=[o,i],s=o):(ae=s,s=n)):(ae=s,s=n);le=t,u=e,t=r.reduce((t,e)=>t||e[1],u)}else ae=t,t=n;var u;return t}function _e(){let t,e,r,s,o,i;if(t=ae,e=Ce(),e!==n){for(r=[],s=ae,o=je(),o!==n?(i=Ce(),i!==n?(o=[o,i],s=o):(ae=s,s=n)):(ae=s,s=n);s!==n;)r.push(s),s=ae,o=je(),o!==n?(i=Ce(),i!==n?(o=[o,i],s=o):(ae=s,s=n)):(ae=s,s=n);le=t,u=e,t=r.reduce((t,e)=>!!t&&!!e[1],u)}else ae=t,t=n;var u;return t}function Ce(){let e,r,s,o;return e=ae,r=Ee(),r!==n?(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,6)===E?(r=E,ae+=6):(r=n,0===de&&we(Ct)),r!==n?(s=Se(),le=e,e="is not"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(_t)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===v?(r=v,ae+=2):(r=n,0===de&&we(yt)),r!==n?(s=Se(),le=e,e=">="):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(gt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,3)===k?(r=k,ae+=3):(r=n,0===de&&we(Ut)),r!==n?(s=Se(),le=e,e="gte"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(Rt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===_?(r=_,ae+=2):(r=n,0===de&&we(wt)),r!==n?(s=Se(),le=e,e="<="):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(xt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,3)===P?(r=P,ae+=3):(r=n,0===de&&we(Dt)),r!==n?(s=Se(),le=e,e="lte"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(qt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,60===t.charCodeAt(ae)?(r=A,ae++):(r=n,0===de&&we(bt)),r!==n?(s=Se(),le=e,e="<"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(mt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===O?(r=O,ae+=2):(r=n,0===de&&we(kt)),r!==n?(s=Se(),le=e,e="lt"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(Pt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,62===t.charCodeAt(ae)?(r=w,ae++):(r=n,0===de&&we(dt)),r!==n?(s=Se(),le=e,e=">"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(pt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===j?(r=j,ae+=2):(r=n,0===de&&we(Ot)),r!==n?(s=Se(),le=e,e="gt"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(jt)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===x?(r=x,ae+=2):(r=n,0===de&&we(ft)),r!==n?(s=Se(),le=e,e="=="):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(ht)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===S?(r=S,ae+=2):(r=n,0===de&&we(St)),r!==n?(s=Se(),le=e,e="is"):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(Et)),e}(),s===n&&(s=function(){let e,r,s;return de++,e=ae,t.substr(ae,2)===C?(r=C,ae+=2):(r=n,0===de&&we(At)),r!==n?(s=Se(),le=e,e="!="):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(vt)),e}()))))))))))),s!==n?(o=Ee(),o!==n?(le=e,e=function(t,e,r){let n;return n=Array.isArray(e)?e.join("").trim():"string"==typeof e?e.trim():String(e).trim(),">="===n||"gte"===n?t>=r:"<="===n||"lte"===n?t<=r:"<"===n||"lt"===n?t<r:">"===n||"gt"===n?t>r:"!="===n||n.includes("is not")?t!=r:("=="===n||"is"===n)&&t==r}(r,s,o)):(ae=e,e=n)):(ae=e,e=n)):(ae=e,e=n),e===n&&(e=function(){let e,r,s;return e=ae,r=function(){let e,r,s;return de++,e=ae,33===t.charCodeAt(ae)?(r=f,ae++):(r=n,0===de&&we(rt)),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(et)),e}(),r!==n?(s=Ce(),s!==n?(le=e,e=!s):(ae=e,e=n)):(ae=e,e=n),e}(),e===n&&(e=function(){let e,r,s,o;return e=ae,r=function(){let e,r,s;return de++,e=ae,40===t.charCodeAt(ae)?(r=a,ae++):(r=n,0===de&&we(W)),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(T)),e}(),r!==n?(s=Ae(),s!==n?(o=function(){let e,r,s;return de++,e=ae,41===t.charCodeAt(ae)?(r=l,ae++):(r=n,0===de&&we(H)),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(Z)),e}(),o!==n?(le=e,e=s):(ae=e,e=n)):(ae=e,e=n)):(ae=e,e=n),e}(),e===n&&(e=Ee()))),e}function Ee(){let e,s;return e=ae,s=function(){let e,r;return de++,e=function(){let e,r,s,o,i,u,a;if(de++,e=ae,r=ae,s=ke(),s===n&&(s=null),o=[],i=Pe(),i!==n)for(;i!==n;)o.push(i),i=Pe();else o=n;if(o!==n)if(i=function(){let e,r;return de++,46===t.charCodeAt(ae)?(e=q,ae++):(e=n,0===de&&we(Mt)),de--,e===n&&(r=n,0===de&&we(Nt)),e}(),i!==n){if(u=[],a=Pe(),a!==n)for(;a!==n;)u.push(a),a=Pe();else u=n;u!==n?(s=[s,o,i,u],r=s):(ae=r,r=n)}else ae=r,r=n;else ae=r,r=n;return r!==n?(s=Se(),le=e,e=Number(r.flat().join(""))):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(Lt)),e}(),e===n&&(e=function(){let t,e,r,s,o;if(de++,t=ae,e=ae,r=ke(),r===n&&(r=null),s=[],o=Pe(),o!==n)for(;o!==n;)s.push(o),o=Pe();else s=n;return s!==n?(r=[r,s],e=r):(ae=e,e=n),e!==n?(r=Se(),le=t,t=Number(e.flat().join(""))):(ae=t,t=n),de--,t===n&&(e=n,0===de&&we(It)),t}()),de--,e===n&&(r=n,0===de&&we(Qt)),e}(),s!==n&&(le=e),e=s,e===n&&(e=ae,s=function(){let e,r,s,o,i;if(de++,e=ae,34===t.charCodeAt(ae)?(r=F,ae++):(r=n,0===de&&we(se)),r!==n){for(s=[],o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));o!==n;)s.push(o),o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));34===t.charCodeAt(ae)?(o=F,ae++):(o=n,0===de&&we(se)),o!==n?(i=Se(),le=e,e=s.join("")):(ae=e,e=n)}else ae=e,e=n;if(e===n)if(e=ae,39===t.charCodeAt(ae)?(r=N,ae++):(r=n,0===de&&we(ie)),r!==n){for(s=[],o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));o!==n;)s.push(o),o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));39===t.charCodeAt(ae)?(o=N,ae++):(o=n,0===de&&we(ie)),o!==n?(i=Se(),le=e,e=s.join("")):(ae=e,e=n)}else ae=e,e=n;return de--,e===n&&(r=n,0===de&&we(ue)),e}(),s!==n&&(le=e),e=s,e===n&&(e=ae,s=function(){let e,s;return de++,e=ae,s=function(){let e,s,o,i;return de++,e=ae,s=De(),s!==n?(o=function(){let e,r,s,o,i;if(de++,e=ae,46===t.charCodeAt(ae)?(r=q,ae++):(r=n,0===de&&we(Mt)),r!==n)if(s=qe(),s!==n){for(o=[],i=qe(),i===n&&(i=Pe());i!==n;)o.push(i),i=qe(),i===n&&(i=Pe());le=e,e=s+o.join("")}else ae=e,e=n;else ae=e,e=n;return de--,e===n&&(r=n,0===de&&we(ee)),e}(),o!==n?(i=Se(),le=e,e=function(t,e){let n=null;if(Object.prototype.hasOwnProperty.call(r,"values")){let s=r.values(t);s&&"object"==typeof s&&e in s&&(n=s[e])}return n}(s,o)):(ae=e,e=n)):(ae=e,e=n),de--,e===n&&(s=n,0===de&&we(Jt)),e}(),s!==n&&(le=e),e=s,e===n&&(e=ae,s=function(){let e,s,o,i,u,a;return de++,e=ae,s=De(),s!==n?(91===t.charCodeAt(ae)?(o=U,ae++):(o=n,0===de&&we(Yt)),o!==n?(i=function(){let e,r,s,o;if(de++,e=ae,r=[],s=qe(),s===n&&(s=Pe(),s===n&&(s=t.charAt(ae),L.test(s)?ae++:(s=n,0===de&&we(ne)))),s!==n)for(;s!==n;)r.push(s),s=qe(),s===n&&(s=Pe(),s===n&&(s=t.charAt(ae),L.test(s)?ae++:(s=n,0===de&&we(ne))));else r=n;if(r!==n&&(le=e,r=r.join("")),e=r,e===n){if(e=ae,34===t.charCodeAt(ae)?(r=F,ae++):(r=n,0===de&&we(se)),r!==n){for(s=[],o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));o!==n;)s.push(o),o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));34===t.charCodeAt(ae)?(o=F,ae++):(o=n,0===de&&we(se)),o!==n?(le=e,e=s.join("")):(ae=e,e=n)}else ae=e,e=n;if(e===n)if(e=ae,39===t.charCodeAt(ae)?(r=N,ae++):(r=n,0===de&&we(ie)),r!==n){for(s=[],o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));o!==n;)s.push(o),o=qe(),o===n&&(o=Pe(),o===n&&(o=t.charAt(ae),V.test(o)?ae++:(o=n,0===de&&we(oe))));39===t.charCodeAt(ae)?(o=N,ae++):(o=n,0===de&&we(ie)),o!==n?(le=e,e=function(t){return t.join("")}(s)):(ae=e,e=n)}else ae=e,e=n}return de--,e===n&&(r=n,0===de&&we(re)),e}(),i!==n?(93===t.charCodeAt(ae)?(u=$,ae++):(u=n,0===de&&we(te)),u!==n?(a=Se(),le=e,e=function(t,e){let n=null;if(Object.prototype.hasOwnProperty.call(r,"values")){let s=r.values(t);s&&"object"==typeof s&&e in s&&(n=s[e])}return n}(s,i)):(ae=e,e=n)):(ae=e,e=n)):(ae=e,e=n)):(ae=e,e=n),de--,e===n&&(s=n,0===de&&we(Xt)),e}(),s!==n&&(le=e),e=s),de--,e===n&&(s=n,0===de&&we(Ht)),e}(),s!==n&&(le=e),e=s,e===n&&(e=ae,s=function(){let t,e;return de++,t=ae,e=function(){let t,e,r;return de++,t=ae,e=De(),e!==n?(r=Se(),le=t,t=e):(ae=t,t=n),de--,t===n&&(e=n,0===de&&we(Wt)),t}(),e!==n&&(le=t,e=function(t){let e=null;return Object.prototype.hasOwnProperty.call(r,"values")&&(e=r.values(t)),e}(e)),t=e,de--,t===n&&(e=n,0===de&&we(Zt)),t}(),s!==n&&(le=e),e=s,e===n&&(e=ae,s=function(){let e,r,s;return de++,e=ae,t.substr(ae,4)===u?(r=u,ae+=4):(r=n,0===de&&we(G)),r!==n?(s=Se(),le=e,e=null):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(z)),e}(),s!==n&&(le=e),e=s,e===n&&(e=function(){let e,r;return de++,e=ae,r=function(){let e,r,s;return de++,e=ae,t.substr(ae,4)===c?(r=c,ae+=4):(r=n,0===de&&we(X)),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(J)),e}(),r!==n&&(le=e,r=!0),e=r,e===n&&(e=ae,r=function(){let e,r,s;return de++,e=ae,t.substr(ae,5)===h?(r=h,ae+=5):(r=n,0===de&&we(tt)),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(Y)),e}(),r!==n&&(le=e,r=!1),e=r),de--,e===n&&(r=n,0===de&&we(B)),e}()))))),e}function Se(){let e,r;for(de++,e=[],r=t.charAt(ae),M.test(r)?ae++:(r=n,0===de&&we(K));r!==n;)e.push(r),r=t.charAt(ae),M.test(r)?ae++:(r=n,0===de&&we(K));return de--,e}function je(){let e,r,s;return de++,e=ae,t.substr(ae,2)===p?(r=p,ae+=2):(r=n,0===de&&we(st)),r===n&&(t.substr(ae,3)===d?(r=d,ae+=3):(r=n,0===de&&we(ot)),r===n&&(t.substr(ae,3)===g?(r=g,ae+=3):(r=n,0===de&&we(it)))),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(nt)),e}function Oe(){let e,r,s;return de++,e=ae,t.substr(ae,2)===y?(r=y,ae+=2):(r=n,0===de&&we(at)),r===n&&(t.substr(ae,2)===m?(r=m,ae+=2):(r=n,0===de&&we(lt)),r===n&&(t.substr(ae,2)===b?(r=b,ae+=2):(r=n,0===de&&we(ct)))),r!==n?(s=Se(),r=[r,s],e=r):(ae=e,e=n),de--,e===n&&(r=n,0===de&&we(ut)),e}function Pe(){let e,r;return de++,e=t.charAt(ae),Q.test(e)?ae++:(e=n,0===de&&we(Ft)),de--,e===n&&(r=n,0===de&&we($t)),e}function ke(){let e,r;return de++,45===t.charCodeAt(ae)?(e=D,ae++):(e=n,0===de&&we(Bt)),de--,e===n&&(r=n,0===de&&we(Vt)),e}function qe(){let e,r;return de++,e=t.charAt(ae),I.test(e)?ae++:(e=n,0===de&&we(Gt)),de--,e===n&&(r=n,0===de&&we(zt)),e}function De(){let e,r,s,o;if(de++,e=ae,36===t.charCodeAt(ae)?(r=R,ae++):(r=n,0===de&&we(Tt)),r!==n){for(s=[],o=qe(),o===n&&(o=Pe());o!==n;)s.push(o),o=qe(),o===n&&(o=Pe());le=e,e=s.join("")}else ae=e,e=n;return de--,e===n&&(r=n,0===de&&we(Kt)),e}he=i();const Re=he!==n&&ae===t.length;function Ue(){throw he!==n&&ae<t.length&&we({type:"end"}),r=pe,s=fe<t.length?function(e=ae){const r=t.codePointAt(e);return void 0===r?"":String.fromCodePoint(r)}(fe):null,o=fe<t.length?xe(fe,fe+1):xe(fe,fe),new e(e.buildMessage(r,s),r,s,o);var r,s,o}return r.peg$library?{peg$result:he,peg$currPos:ae,peg$FAILED:n,peg$maxFailExpected:pe,peg$maxFailPos:fe,peg$success:Re,peg$throw:Re?void 0:Ue}:Re?he:void Ue()}}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};r.r(n),r.d(n,{Card:()=>g,Deck:()=>y,Expression:()=>u,QualitySet:()=>l,State:()=>a,default:()=>m});var s=r(698),o=r.n(s);const{parse:i}=o();class u{constructor(t){this._expression="",this.change(t)}get expression(){return this._expression}change(t){if("string"!=typeof t)throw new Error("Expressions must be strings!");this._expression=t}check(t){if(!t||!t.keys)return!1;try{const e=e=>t.keys[e];return i(this._expression,{values:e})}catch(t){return console.warn("Expression check failed:",t),!1}}}class a{constructor(){this._values={}}get keys(){return this._values}set(t,e){this._values[t]=e}get(t){let e=null;return this.exists(t)&&(e=this._values[t]),e}delete(t){let e=null;return this.exists(t)&&(e=this.get(t),delete this._values[t]),e}exists(t){return Object.prototype.hasOwnProperty.call(this._values,t)}size(){return Object.keys(this._values).length}}class l{constructor(){this._set=[]}add(t){if("string"!=typeof t)throw new Error("Qualities must be strings!");if(!this.has(t)){const e=new u(t);this._set.push(e)}}has(t){if("string"!=typeof t)throw new Error("Can only check string values!");return this._set.some(e=>e.expression===t)}remove(t){if("string"!=typeof t)throw new Error("Must pass string values to remove!");this._set=this._set.filter(e=>e.expression!==t)}check(t){if(t instanceof a)return this._set.every(e=>e.check(t));throw new Error("Must have State to check() against!")}size(){return this._set.length}}const c={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let h;const f=new Uint8Array(16),p=[];for(let t=0;t<256;++t)p.push((t+256).toString(16).slice(1));function d(t,e,r){const n=(t=t||{}).random??t.rng?.()??function(){if(!h){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");h=crypto.getRandomValues.bind(crypto)}return h(f)}();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){if((r=r||0)<0||r+16>e.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let t=0;t<16;++t)e[r+t]=n[t];return e}return function(t,e=0){return(p[t[e+0]]+p[t[e+1]]+p[t[e+2]]+p[t[e+3]]+"-"+p[t[e+4]]+p[t[e+5]]+"-"+p[t[e+6]]+p[t[e+7]]+"-"+p[t[e+8]]+p[t[e+9]]+"-"+p[t[e+10]]+p[t[e+11]]+p[t[e+12]]+p[t[e+13]]+p[t[e+14]]+p[t[e+15]]).toLowerCase()}(n)}class g{constructor(t="",e=[]){var r,n,s;this._content="",this._qualities=new l,this.content=t,this.qualities=e,this._hash=!c.randomUUID||n||r?d(r,n,s):c.randomUUID()}get content(){return this._content}set content(t){if("string"!=typeof t)throw new Error("Content must be expressed as a string!");this._content=t}get qualities(){return this._qualities}set qualities(t){this._qualities=new l,t.forEach(t=>this.addQuality(t))}get hash(){return this._hash}isAvailable(t){if(t instanceof a)return this._qualities.check(t);throw new Error("Must be passed State to check if available")}addQuality(t){this._qualities.add(t)}removeQuality(t){this._qualities.remove(t)}}class y{constructor(){this.cards=[],this._state=new a}get state(){return this._state}set state(t){if(!(t instanceof a))throw new Error("Passed value is not an instance of State");this._state=t}getCard(t=-1){let e=null;return t>=0&&t<this.cards.length&&(e=this.cards[t]),e}updateCard(t){if(!(t instanceof g))throw new Error("Updated card must be Card!");this.cards.forEach((e,r)=>{e.hash===t.hash&&(this.cards[r]=t)})}size(){return this.cards.length}addCard(t,e=[]){if("string"!=typeof t)throw new Error("Card content must be string!");if(!Array.isArray(e))throw new Error("Qualities must be passed as array!");const r=new g(t,e);this.cards.push(r)}removeCard(t){this.cards=this.cards.filter(e=>e!==t)}shuffle(){for(let t=this.cards.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.cards[t],this.cards[e]]=[this.cards[e],this.cards[t]]}}draw(t=1){let e=[];return t>0&&(e=this.cards.filter(t=>t.isAvailable(this.state)),e=e.slice(0,t)),e}}"undefined"!=typeof window&&(window.SimpleQBN={Card:g,Deck:y,Expression:u,QualitySet:l,State:a});const m={Card:g,Deck:y,Expression:u,QualitySet:l,State:a};return n})());